<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dice Defense - Playground V3</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/remixicon@4.8.0/fonts/remixicon.css" rel="stylesheet"/>
    <link href="css/style.css" rel="stylesheet"/>
</head>
<body class="bg-slate-100 h-[100dvh] flex flex-col">

    <nav class="flex-none h-16 bg-white flex justify-between items-center px-4 shadow-sm z-50">
        <div class="flex items-center gap-3">
            <button onclick="location.href='../home.html'" class="text-slate-500 hover:text-blue-600 transition-colors">
                <i class="ri-arrow-left-line text-2xl"></i>
            </button>
            <h1 class="text-lg font-bold text-slate-800 select-none">Dice Defense</h1>
        </div>
        <div class="flex gap-3 text-xs font-bold text-slate-600 bg-slate-100 px-3 py-1.5 rounded-full">
            <div class="flex items-center gap-1"><i class="ri-vip-diamond-fill text-blue-500 text-sm"></i> <span id="res-gem">0</span></div>
            <div class="w-px h-3 bg-slate-300"></div>
            <div class="flex items-center gap-1"><i class="ri-coins-fill text-yellow-500 text-sm"></i> <span id="res-gold">0</span></div>
            <div class="w-px h-3 bg-slate-300"></div>
            <div class="flex items-center gap-1"><i class="ri-coupon-3-fill text-purple-500 text-sm"></i> <span id="res-ticket">0</span></div>
        </div>
    </nav>

    <main class="flex-1 relative w-full max-w-lg mx-auto bg-slate-50 shadow-2xl overflow-hidden md:border-x md:border-slate-200">
        <div id="tab-shop" class="tab-content flex-col items-center p-4 space-y-4"></div>
        <div id="tab-deck" class="tab-content flex-col p-4"></div>
        <div id="tab-battle" class="tab-content active flex-col p-4 relative"></div>
        <div id="tab-event" class="tab-content flex-col p-4 space-y-4"></div>
        <div id="tab-clan" class="tab-content flex-col p-4 space-y-4"></div>

        <div id="dice-popup" onclick="if(event.target === this) closePopup()" class="absolute inset-0 z-50 bg-black/50 hidden items-center justify-center p-4 backdrop-blur-sm transition-opacity duration-200">
            <div class="bg-white w-full max-w-sm rounded-3xl shadow-2xl relative animate-[fadeIn_0.2s_ease-out] flex flex-col scrollbar-hide popup-compact" onclick="event.stopPropagation()">
                <button onclick="closePopup()" class="absolute top-3 right-3 text-slate-400 hover:text-slate-600 z-20 p-2">
                    <i class="ri-close-line text-2xl"></i>
                </button>
                <div class="flex items-center gap-4 mb-2">
                    <div id="popup-dice-icon-container" class="shrink-0 relative"></div>
                    <div>
                        <h3 id="popup-dice-name" class="text-xl font-bold text-slate-800">Dice Name</h3>
                        <div class="flex gap-2 mt-1">
                            <span id="popup-dice-rarity" class="text-[10px] font-bold px-2 py-0.5 rounded bg-slate-100 text-slate-500">Common</span>
                            <span id="popup-dice-class" class="text-[10px] font-bold px-2 py-0.5 rounded bg-blue-50 text-blue-600">Lv.1</span>
                        </div>
                    </div>
                </div>
                <p id="popup-dice-desc" class="text-xs text-slate-500 mb-2 bg-slate-50 p-2 rounded-lg leading-tight">설명...</p>
                <div id="popup-stats-grid" class="grid grid-cols-2 gap-2 mb-2"></div>
                <div class="flex gap-2 mb-2">
                    <button id="btn-view-class" onclick="toggleViewMode('class')" class="flex-1 py-2 rounded-lg text-xs font-bold border border-slate-200 text-slate-500 hover:bg-slate-50 transition-colors">클래스 업</button>
                    <button id="btn-view-power" onclick="toggleViewMode('power')" class="flex-1 py-2 rounded-lg text-xs font-bold border border-slate-200 text-slate-500 hover:bg-slate-50 transition-colors">파워 업</button>
                </div>
                <div class="mt-auto pt-2 border-t border-slate-100">
                    <div class="flex justify-between text-xs mb-1">
                        <span class="text-slate-500">보유 카드</span>
                        <span id="popup-dice-cards" class="font-bold text-blue-600">0 / 5</span>
                    </div>
                    <div class="w-full bg-slate-200 h-1.5 rounded-full overflow-hidden mb-3">
                        <div id="popup-progress-bar" class="bg-blue-500 h-full w-0 transition-all duration-500"></div>
                    </div>
                    <button id="popup-action-btn" class="relative w-full py-3 rounded-xl font-bold text-white shadow-lg transition-transform active:scale-95 flex items-center justify-center gap-2 overflow-hidden">
                        <span>업그레이드</span>
                    </button>
                    <div id="popup-cost-info" class="text-xs text-slate-400 mt-1 text-center font-medium">비용: 1000골드</div>
                </div>
            </div>
        </div>

        <div id="summon-overlay" class="absolute inset-0 z-[60] hidden flex-col items-center justify-center bg-slate-900/95 backdrop-blur-md">
            <div id="summon-tap-area" class="absolute inset-0 z-0 hidden cursor-pointer"></div>
            
            <div class="relative z-10 flex flex-col items-center justify-center w-full h-full pointer-events-none">
                <div id="summon-dice-container" class="relative w-32 h-32 transition-all duration-300 pointer-events-auto flex items-center justify-center">
                    </div>
                
                <div id="summon-text-area" class="absolute bottom-32 w-full text-center hidden transition-all duration-500 pointer-events-none">
                    <h2 id="summon-dice-name" class="text-3xl font-extrabold text-white drop-shadow-lg mb-2">Name</h2>
                    <div class="text-slate-400 text-sm animate-pulse">화면을 터치하여 계속</div>
                </div>
            </div>
        </div>

    </main>

    <nav class="flex-none h-20 bg-white border-t border-slate-200 flex justify-between items-center px-1 pb-2 shadow-[0_-5px_20px_rgba(0,0,0,0.05)] z-50"
         style="padding-bottom: calc(0.5rem + env(safe-area-inset-bottom)); box-sizing: content-box; height: 4rem;">
        <button onclick="switchTab('shop')" class="nav-btn flex-1 flex flex-col items-center gap-1 text-slate-400 hover:text-slate-600 transition-colors" data-target="tab-shop"><i class="ri-store-3-fill text-2xl mb-0.5"></i><span class="text-[10px] font-bold">상점</span></button>
        <button onclick="switchTab('deck')" class="nav-btn flex-1 flex flex-col items-center gap-1 text-slate-400 hover:text-slate-600 transition-colors" data-target="tab-deck"><i class="ri-layout-grid-fill text-2xl mb-0.5"></i><span class="text-[10px] font-bold">덱</span></button>
        <div class="w-16 relative flex justify-center"><button onclick="switchTab('battle')" class="nav-btn absolute -top-10 w-16 h-16 bg-blue-600 rounded-full flex flex-col items-center justify-center text-white shadow-lg shadow-blue-200 ring-4 ring-white transition-transform active:scale-95" data-target="tab-battle"><i class="ri-gamepad-fill text-3xl"></i></button></div>
        <button onclick="switchTab('event')" class="nav-btn flex-1 flex flex-col items-center gap-1 text-slate-400 hover:text-slate-600 transition-colors" data-target="tab-event"><i class="ri-gift-fill text-2xl mb-0.5"></i><span class="text-[10px] font-bold">이벤트</span></button>
        <button onclick="switchTab('clan')" class="nav-btn flex-1 flex flex-col items-center gap-1 text-slate-400 hover:text-slate-600 transition-colors" data-target="tab-clan"><i class="ri-group-fill text-2xl mb-0.5"></i><span class="text-[10px] font-bold">클랜</span></button>
    </nav>

    <script src="js/state.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/api.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/game.js"></script>
    <script src="js/main.js"></script>
</body>
</html>